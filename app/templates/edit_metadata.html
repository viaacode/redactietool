{% extends 'base.html' %}

{% block header %}
{% endblock %}

{% block title %}
Metadata bewerken
{% endblock %}

{% block content %}

<div class="columns">
  <div class="column">

    <h1 class="title">{{title}}</h1>
    <h2 class="subtitle pu mb-0 ml-1"><b>PID: {{pid}}</b></h2>

    <!--
      Unless someone can truly convince me this double button is really necessary
      I'm keeping it hidden for now.
      <div class="buttons is-pulled-right pt-2">
            <a class="button is-link mb-5"
               href="/upload?token={{token}}&pid={{pid}}&department={{department}}">
              Bewerk ondertitels
            </a>
      </div>
    -->
  </div> 
</div>


{% if data_saved_to_mam %}
  <div class="columns" id="data_saved_alert_box">
    <div class="column">
      <div class="notification is-success">
        <button class="delete" onclick="closeSavedAlert(); return false;"></button>
        De metadata voor item <b>{{pid}}</b> werd verstuurd naar Mediahaven. <br/>
        <!--
        Deze call is async en het kan even duren vooraleer de get request de nieuwe aanpassingen weergeeft.
        -->
      </div>
    </div>
  </div>
{% endif %}

<div class="columns">
  <div class="column">
    <div id="player_container"></div>

    <script>
      flowplayer('#player_container', {
        src: '{{video_url}}',
        token: '{{flowplayer_token}}'
      })
    </script>

    <a class="button is-info mt-5" href="{{keyframe_edit_url}}" target="_blank">
      <ion-icon name="key-outline" class="pr-3"></ion-icon>
      Keyframe Aanpassen
    </a>

  </div>
</div>

<form class="metadata_form" action="/edit_metadata" method="POST" enctype="multipart/form-data">

  {% include 'upload_hidden_fields.html' %}

  <div class="columns">
    <div class="column">
      <h2 class="title is-clickable" onclick="sectionToggle('algemene_metadata')">
        Algemene metadata
        <div class="minimize-icon-wrapper" id="algemene_metadata_icon">
          <span class="icon-unfolded">
            <ion-icon name="chevron-down-circle-outline"></ion-icon>
          </span>
          <span class="icon-folded">
            <ion-icon name="chevron-forward-circle-outline"></ion-icon>
          </span>
        </div>
      </h2>
      <hr/>
    </div>
  </div>

  <div id="algemene_metadata">
    <div class="columns">
      <div class="column is-half">
        <h3 class="subtitle">Algemeen</h3>
        
        <div class="field is-horizontal">
          <div class="field-label is-normal">
            <label class="label">Beherende&nbsp;CP</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="beherende_cp" class="input is-small" type="text" placeholder="Beherende CP" value="{{original_cp}}" readonly/>
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal">
          <div class="field-label is-normal">
            <label class="label">Testbeeld&nbsp;PID</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="testbeeld_pid" class="input is-small" type="text" placeholder="PID" value="{{pid}}" readonly/>
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal">
          <div class="field-label is-normal">
            <label class="label">Lokale CP ID</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="testbeeld_pid" 
                class="input is-small" type="text" 
                placeholder="PID" value="{{dc_identifier_localid}}" readonly/>
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal">
          <div class="field-label is-normal">
            <label class="label">Uitzenddatum</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="uitzenddatum" class="input is-small" type="text" placeholder="Uitzenddatum" value="{{dcterms_issued}}"/>
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal">
          <div class="field-label is-normal">
            <label class="label">Creatiedatum</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="creatiedatum" class="input is-small" type="text" placeholder="creatie datum" value="{{created}}" readonly/>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="column is-half">
        <h3 class="subtitle">Titel</h3>

        <div class="field is-horizontal">
          <div class="field-label is-normal">
            <label class="label">Ontsluitingstitel</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="ontsluitingstitel" 
                  class="input is-small" type="text" 
                  placeholder="editable" value="{{ontsluitingstitel}}">
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal">
          <div class="field-label is-normal">
            <label class="label">Hoofdtitel</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="hoofdtitel" 
                  class="input is-small" type="text" 
                  placeholder="title" value="{{title}}" readonly>
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal" id="titel_serie">
          <div class="field-label is-normal">
            <label class="label">Serie</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="serie" class="input is-small" type="text" 
                placeholder="Secundaire titel: serie"
                value="{{titel_serie}}">
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal" id="titel_episode">
          <div class="field-label is-normal">
            <label class="label">Episode</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="serie" class="input is-small" type="text" 
                placeholder="Secundaire titel: episode"
                value="{{titel_episode}}">
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal" id="titel_aflevering">
          <div class="field-label is-normal">
            <label class="label">Aflevering</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="serie" class="input is-small" type="text" 
                placeholder="Secundaire titel: aflevering"
                value="{{titel_aflevering}}">
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal" id="titel_alternatief">
          <div class="field-label is-normal">
            <label class="label">Alternatief</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="alternatief" class="input is-small" type="text" 
                placeholder="Secundaire titel: aflevering" 
                value="{{titel_alternatief}}"
                readonly>
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal" id="titel_programma">
          <div class="field-label is-normal">
            <label class="label">Programma</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="programma" class="input is-small" type="text" 
                  placeholder="Secundaire titel: programma" 
                  value="{{titel_programma}}"
                  readonly>
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal" id="titel_serienummer">
          <div class="field-label is-normal">
            <label class="label">Serienummer</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="serienummer" class="input is-small" type="text" 
                  placeholder="Secundaire titel: serienummer" 
                  value="{{titel_serienummer}}"
                  readonly>
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal" id="titel_seizoen">
          <div class="field-label is-normal">
            <label class="label">Seizoen</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="seizoen" 
                  class="input is-small" 
                  type="text" 
                  placeholder="Secundaire titel: seizoen" 
                  value="{{titel_seizoen}}"
                  readonly>
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal" id="titel_nummer">
          <div class="field-label is-normal">
            <label class="label">Nummer</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="seizoen" 
                  class="input is-small" 
                  type="text" 
                  placeholder="Secundaire titel: seizoen nummer" 
                  value="{{titel_seizoen_nr}}"
                  readonly>
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal" id="titel_archief">
          <div class="field-label is-normal">
            <label class="label">Archief</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="seizoen" 
                  class="input is-small" 
                  type="text" 
                  placeholder="Secundaire titel: archief" 
                  value="{{titel_archief}}"
                  readonly>
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal" id="titel_deelarchief">
          <div class="field-label is-normal">
            <label class="label">Deelarchief</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="seizoen" 
                  class="input is-small" 
                  type="text" 
                  placeholder="Secundaire titel: deelarchief" 
                  value="{{titel_deelarchief}}"
                  readonly>
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal" id="titel_reeks">
          <div class="field-label is-normal">
            <label class="label">Reeks</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="seizoen" 
                  class="input is-small" 
                  type="text" 
                  placeholder="Secundaire titel: reeks" 
                  value="{{titel_reeks}}"
                  readonly>
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal" id="titel_deelreeks">
          <div class="field-label is-normal">
            <label class="label">Deelreeks</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="deelreeks" 
                  class="input is-small" 
                  type="text" 
                  placeholder="Secundaire titel: deelreeks" 
                  value="{{titel_deelreeks}}"
                  readonly>
              </div>
            </div>
          </div>
        </div>

        <div class="field is-horizontal" id="titel_registratie">
          <div class="field-label is-normal">
            <label class="label">Registratie</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input name="deelreeks" 
                  class="input is-small" 
                  type="text" 
                  placeholder="Secundaire titel: registratie" 
                  value="{{titel_registratie}}"
                  readonly>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div> <!-- section wrapper div for hide/unhide -->
  </div>



  <div class="columns">
    <div class="column">
      <h2 class="title is-clickable" onclick="sectionToggle('productie_section')">
        Productie
        <div class="minimize-icon-wrapper" id="productie_section_icon">
          <span class="icon-unfolded">
            <ion-icon name="chevron-down-circle-outline"></ion-icon>
          </span>
          <span class="icon-folded">
            <ion-icon name="chevron-forward-circle-outline"></ion-icon>
          </span>
        </div>
      </h2>
      <hr/>
      
      <div id="productie_section">
      {% include 'components/maker_select.html' %}
      {% include 'components/bijdrager_select.html' %}
      {% include 'components/publisher_select.html' %}
      </div>
 
    </div>
  </div>




  <div class="columns">
    <div class="column">
      <h2 class="title is-clickable" onclick="sectionToggle('inhoud_section')">
        Inhoud
        <div class="minimize-icon-wrapper" id="inhoud_section_icon">
          <span class="icon-unfolded">
            <ion-icon name="chevron-down-circle-outline"></ion-icon>
          </span>
          <span class="icon-folded">
            <ion-icon name="chevron-forward-circle-outline"></ion-icon>
          </span>
        </div>
      </h2>
      <hr/>

      <div id="inhoud_section">
        <article class="panel">
           <p class="panel-heading">
             Hoofdbeschrijving
           </p>
           <div class="panel-block">
             <p class="control">
               <textarea name="originele_hoofdbeschrijving"
                 id="originele_hoofdbeschrijving"
                 class="textarea is-hover" 
                 placeholder="Originele hoofdbeschrijving"
                 cols="45"
                 rows="5" readonly>{{description}}</textarea>
             </p>

           </div>
        </article>

        <article class="panel">
          <p class="panel-heading">
            Uitgebreide beschrijving
          </p>
          <div class="panel-block">
            <p class="control">
              <textarea name="originele_uitgebreide_hoofdbeschrijving"
                id="originele_uitgebreide_hoofdbeschrijving"
                class="textarea is-hover" 
                placeholder="Originele uitgebreide hoofdebeschrijving"
                cols="45"
                rows="5" readonly>{{dc_description_lang}}</textarea>
            </p>
          </div>
        </article>

        <article class="panel">
          <p class="panel-heading">
            Ondertitels
          </p>
          <div class="panel-block">
            <p class="control">
              <textarea name="ondertitels"
                id="ondertitels"
                class="textarea is-hover" 
                placeholder="Ondertitles (read-only)" 
                cols="45"
                rows="5" readonly>{{ondertitels}}</textarea>
            </p>
          </div>
        </article>

        <article class="panel">
          <p class="panel-heading">
            Programma beschrijving
          </p>
          <div class="panel-block">
            <p class="control">
              <textarea name="programma_beschrijving"
                id="programma_beschrijving"
                class="textarea is-hover" 
                placeholder="Programma omschrijving (read-only)" 
                cols="45"
                rows="5" readonly>{{programma_beschrijving}}</textarea>
            </p>
          </div>
        </article>

        <article class="panel">
          <p class="panel-heading">
            Cast 
          </p>
          <div class="panel-block">
            <p class="control">
              <textarea name="cast"
                id="cast"
                class="textarea is-hover" 
                placeholder="Cast (read-only)" 
                cols="45"
                rows="5" readonly>{{cast}}</textarea>
            </p>
          </div>
        </article>

        <article class="panel">
          <p class="panel-heading">
            Transcriptie
          </p>
          <div class="panel-block">
            <p class="control">
              <textarea name="transcriptie"
                id="transcriptie"
                class="textarea is-hover" 
                placeholder="Transcriptie (read-only)" 
                cols="45"
                rows="5" readonly>{{transcriptie}}</textarea>
            </p>

          </div>
        </article>

        <!-- deze is een editable panel en in toekomst wss een rich text edit indien nog gewenst -->
        <article class="panel">
          <p class="panel-heading">
            Het archief voor Onderwijs beschrijving
          </p>
          <div class="panel-block">
            <p class="control">
              <textarea name="avo_beschrijving"
                id="avo_beschrijving"
                class="textarea is-hover" 
                placeholder="AVO beschrijving" 
                cols="45"
                rows="10">{{avo_beschrijving}}</textarea>
            </p>

          </div>
        </article>
      </div> <!-- inhoud_section -->

    </div>
  </div>

  
  <div class="columns">
    <div class="column">
      <h2 class="title is-clickable" onclick="sectionToggle('lom1_section')">
        Leerobjectmetadata trap 1
        <div class="minimize-icon-wrapper" id="lom1_section_icon">
          <span class="icon-unfolded">
            <ion-icon name="chevron-down-circle-outline"></ion-icon>
          </span>
          <span class="icon-folded">
            <ion-icon name="chevron-forward-circle-outline"></ion-icon>
          </span>
        </div>
      </h2>
      <hr/>

      <div id="lom1_section">
        <div class="field is-horizontal">
          <div class="field-label is-normal">
            <label class="label">Type</label>
          </div>
          <div class="field-body">
            <div class="select">
              <select name="lom1_type" id="lom1_type">
                <option value="video">Video</option>
                <option value="audio">Audio</option>
              </select>
            </div>
          </div>
        </div>

        <div class="field is-horizontal">
          <div class="field-label is-normal">
            <label class="label label-two-lines">Beoogde eindgebruiker</label>
          </div>
          <div class="field-body">
            <div class="select is-multiple">
              <!-- TODO: multiple size="3" of meer? -->
              <select name="lom1_beoogde_eindgebruiker" id="lom1_beoogde_eindgebruiker">
                <option value="Docent">Docent</option>
                <option value="Student">Student</option>
                <option value="Directie">Directie</option>
                <option value="ICT-coördinator">ICT-coördinator</option>
                <option value="Systeembeheerder">Systeembeheerder</option>
                <option value="Preventieadviseur">Preventieadviseur</option>
                <option value="GOK">GOK / Zorgcoördinator</option>
                <option value="Pedagogisch begeleider">Pedagogisch begeleider</option>
                <option value="Inspectielid">Inspectielid</option>
                <option value="Administratief personeel">Administratief personeel</option>
                <option value="Met pensioen">Met pensioen</option>
                <option value="Ouder">Ouder</option>
                <option value="Ander">Ander</option>
              </select>
            </div>
          </div>
        </div>

        {% include 'components/language_select.html' %}

        <!-- TODO: validation error on empty value for onderwijsniveaus -->
        <!-- of gewoon by default een selectie? -->
        <div class="field is-horizontal">
          <div class="field-label is-normal">
            <label class="label">Onderwijsniveaus</label>
          </div>
          <div class="field-body">
            <div class="select is-multiple">
              <!-- TODO: multiple size="2" -->
              <!-- TODO: lookup in ACM+ldap-api if these need to be 
                lower-case values or not same for above eindgebruiker field -->
              <select name="lom1_onderwijsniveaus" id="lom1_onderwijsniveaus">
                <option value="Kleuteronderwijs">Kleuteronderwijs</option>
                <option value="Lager onderwijs">Lager onderwijs</option>
                <option value="Secundair onderwijs">Secundair onderwijs</option>
                <option value="Volwassenenonderwijs">Volwassenenonderwijs</option>
                <option value="Hoger onderwijs">Hoger onderwijs</option>
              </select>
            </div>
          </div>
        </div>

        <!-- TODO: clear onderwijsgraden als onderwijsniveau verandert? of een error message? -->
        <!-- TODO: re-populate als onderwijsniveaus verandert, met welke api call? -->
        <!-- field is disabled tot dat onderwijsniveau is gekozen en api call response er is om
          het veld in te vullen-->
        <div class="field is-horizontal">
          <div class="field-label is-normal">
            <label class="label">Onderwijsgraden</label>
          </div>
          <div class="field-body">
            <div class="select is-multiple is-loading" >
              <!-- TODO: multiple size="2" -->
              <select name="lom1_onderwijsgraden" id="lom1_onderwijsgraden">
                <option value="value1">Api call met als parameter onderwijsnivea...</option>
                <option value="value2">toon effectieve graden na response api call.</option>
              </select>
            </div>
          </div>
        </div>

        <!-- TODO: thema's are from knowledge graph or? -->
        <div class="field is-horizontal">
          <div class="field-label is-normal">
            <label class="label">Thema</label>
          </div>
          <div class="field-body">
            <div class="select">
              <select name="lom1_themas" id="lom1_themas">
                <option value="value1">Thema kan ook met cards, of inline multi-select...</option>
              </select>
            </div> 
          </div>
        </div>

        <div class="notification is-warning">
       Verwijderen van een thema zou enkel een popup moeten tonen indien er vakken zijn geselecteerd die aan dit thema hangen (de 'ok' van die popup verwijdert de vakken, de 'annuleren' doet een undo van het verwijderen van dat thema). Een thema toevoegen of een verwijderen die geen related vakken heeft zou gewoon transparant moeten werken. Opmerking: en zolang je niet op 'Metadata opslaan' clicked kan je altijd nog de wijziging ongedaan maken door weg te navigeren en terug te komen (of refresh...).
        </div>

      </div> <!-- lom1_section -->
    </div>
  </div>




  <div class="columns">
    <div class="column">
      <h2 class="title is-clickable" onclick="sectionToggle('lom2_section')">
        Leerobjectmetadata trap 2
        <div class="minimize-icon-wrapper" id="lom2_section_icon">
          <span class="icon-unfolded">
            <ion-icon name="chevron-down-circle-outline"></ion-icon>
          </span>
          <span class="icon-folded">
            <ion-icon name="chevron-forward-circle-outline"></ion-icon>
          </span>
        </div>
      </h2>
      <hr/>

      <div id="lom2_section">
        <!-- waarom niet gewoon een multi-select hier? 
          het is toch niet editeerbaar, waarom die 'X' op de wireframe? 

          Je wilt gewoon een deel-lijstje van vakken uit alle mogelijke vakken selecteren
          dat is een bestaande component en heet een multiselect...
        -->
        <div class="field is-horizontal">
          <div class="field-label is-normal">
            <label class="label">Vakken</label>
          </div>
          <div class="field-body">
            <div class="select is-multiple">
              <select name="lom2_vakken" id="lom2_vakken">
                <option value="value1">Mag dit niet gewoon een multi-select worden?</option>
                <option value="value1">tweede vak</option>
              </select>
            </div>
          </div>
        </div> 
      </div> <!-- lom2_section -->

    </div>
  </div>





  <div class="columns">
    <div class="column">
      <h2 class="title is-clickable" onclick="sectionToggle('lom3_section')">
        Leerobjectmetadata trap 3
        <div class="minimize-icon-wrapper" id="lom3_section_icon">
          <span class="icon-unfolded">
            <ion-icon name="chevron-down-circle-outline"></ion-icon>
          </span>
          <span class="icon-folded">
            <ion-icon name="chevron-forward-circle-outline"></ion-icon>
          </span>
        </div>
      </h2>
      <hr/>

      <div id="lom3_section">
        <!-- 
          Dus trefwoorden is een searchable dropdown die suggesties geeft als je typt.
          Indien je een niet bestaande trefwoord kiest mag hier een popup komen met:

          Ben je zeker dat je een nieuw trefwoord wilt toevoegen dat nog niet op
          Het Archief voor Onderwijs staat?

          JA / Annuleren -> en dus ja zal een call moeten maken om dit ergens op te slaan.
          Annuleren moet gewoon de plus negeren en select weer leeg maken
        -->
        <div class="field is-horizontal">
          <div class="field-label is-normal">
            <label class="label">Trefwoorden</label>
          </div>
          <div class="field-body">
            <div class="select is-multiple">
              <select name="lom3_trefwoorden" id="lom3_trefwoorden">
                <option value="value1">TODO: Searchable select hier</option>
                <option value="value2"></option>
              </select>
            </div>

            <button onclick="addTrefwoord('trefwoorden_lijst', 'some_div'); return false;" 
              class="button is-info ml-2">+</button>
          </div>
        </div>

        <div class="field is-horizontal">
          <div class="field-label is-normal">
            <label class="label"></label>
          </div>
          <div class="field-body">
              <a target="_blank" href="http://link_trefwoorden_content_partners?">
                Bekijk trefwoorden van Content Partners
              </a>
          </div>
        </div>

        <div class="notification is-warning">
          Dit is searchable select dus je kan typen. Als je dan niet een bestaande trefwoord toevoegt
          met de + dan krijg je een popup. Deze moet dan het nieuwe trefwoord opslaan met een api call (deze moet juist gegeven worden in een ticket). Je kan ook annuleren en dan cleared dat de select en moet je een ander bestaande trefwoord zoeken.
          De link met trefwoorden contentpartners ontbreekt nog momenteel of komt hier een andere call voor?
        </div>

      </div> <!-- lom3_section -->
    </div>
  </div>


  <div class="columns">
    <div class="column">
      <h2 class="title">Publicatiestatus</h2>
      <hr/>
      <label class="checkbox">
        <input type="checkbox" name="publicatiestatus"/>
        Dit item mag gepubliceerd worden op 
        <a target="blank" href="https://onderwijs.hetarchief.be">Het Archief voor Onderwijs.</a>
      </label>
    </div>
  </div>

  <div class="columns">
    <div class="column">
      <div class="buttons sticky-submit-button pt-2">
        {% include 'includes/form_errors.html' %}
        <button type="submit" class="button is-primary spring">
          Metadata opslaan
        </button>
      </div>
    </div>
  </div>

</form> <!-- end of metadata edit form -->
<br/><br/><br/><br/>

{% endblock %}
